{% extends "base.html" %}
{% block content %}
    <h2>Welcome, {{ current_user.username }}!</h2>

    <!-- Add Task Form -->
    <form method="POST" action="{{ url_for('add_task') }}">
    <input type="text" name="name" placeholder="Task Name" required>
    <select name="category" required>
        <option value="" disabled selected>Select Category</option>
        {% for cat in categories %}
            <option value="{{ cat }}">{{ cat }}</option>
        {% endfor %}
    </select>
    <select name="priority" required>
        <option value="" disabled selected>Select Priority</option>
        {% for pri in priorities %}
            <option value="{{ pri }}">{{ pri }}</option>
        {% endfor %}
    </select>
    <input type="date" name="due_date">
    <button type="submit">Add Task</button>
</form>


    <!-- Filters -->
    <form method="GET" action="{{ url_for('home') }}">
        <select name="category">
            <option value="">All Categories</option>
            {% for category in categories %}
                <option value="{{ category }}">{{ category }}</option>
            {% endfor %}
        </select>
        <select name="priority">
            <option value="">All Priorities</option>
            {% for priority in priorities %}
                <option value="{{ priority }}">{{ priority }}</option>
            {% endfor %}
        </select>
        <button type="submit">Filter</button>
    </form>

    <!-- Task List -->
    <ul>
    {% if tasks %}
        {% for task in tasks %}
            <li>
                <strong>Name:</strong> {{ task.name }} <br>
                <strong>Category:</strong> {{ task.category }} <br>
                <strong>Priority:</strong> {{ task.priority }} <br>
                <strong>Due Date:</strong> {{ task.due_date or 'No due date' }} <br>
                <strong>Status:</strong> {% if task.completed %}Completed{% else %}Incomplete{% endif %}
                <form method="POST" action="{{ url_for('update_task', task_id=task.id) }}" style="display:inline;">
                    <button type="submit">Toggle</button>
                </form>
                <form method="POST" action="{{ url_for('delete_task', task_id=task.id) }}" style="display:inline;">
                    <button type="submit">Delete</button>
                </form>
            </li>
        {% endfor %}
    {% else %}
        <li>No tasks available.</li>
    {% endif %}
</ul>


    <!-- Delete Account -->
    <form method="POST" action="{{ url_for('delete_account') }}">
        <button type="submit" class="btn btn-danger">Delete Account</button>
    </form>
{% endblock %}


